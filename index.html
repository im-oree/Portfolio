<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Are you vexing with me?</title>
  <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.5.1/dist/confetti.browser.min.js"></script>
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
    /* Falling hearts */
    .heart {
      position: fixed;
      top: -20px;
      font-size: 24px;
      animation: fall 5s linear forwards;
      z-index: 9999;
    }
    @keyframes fall {
      to {
        transform: translateY(110vh) rotate(360deg);
        opacity: 0;
      }
    }
  </style>
</head>
<body class="bg-pink-100 flex items-center justify-center h-screen">
  <div id="container" class="bg-white p-6 rounded-2xl shadow-lg w-[350px] text-center">
    
    <!-- Step 1 -->
    <div id="step1">
      <h1 class="text-xl font-bold mb-4">Are you vexing with me? ðŸ˜¢</h1>
      <button id="noBtn" class="bg-red-400 text-white px-4 py-2 rounded-lg m-2">No</button>
      <button id="yesBtn" class="bg-green-400 text-white px-4 py-2 rounded-lg m-2">Yes</button>
    </div>
    
    <!-- Step 2 (reason input) -->
    <div id="step2" class="hidden">
      <h1 class="text-lg font-semibold mb-4">Why are you vexing with me? ðŸ˜­</h1>
      <form id="reasonForm" action="https://formspree.io/f/xandrbna" method="POST">
        <textarea name="reason" class="w-full border rounded-lg p-2 mb-3" placeholder="Type your reason..."></textarea>
        <button type="submit" class="bg-blue-500 text-white px-4 py-2 rounded-lg">Submit</button>
      </form>
    </div>
    
    <!-- Step 3 -->
    <div id="step3" class="hidden">
      <h1 class="text-xl font-bold mb-4">Are you going to forgive me? ðŸ¥º</h1>
      <button id="forgiveNoBtn" class="bg-red-400 text-white px-4 py-2 rounded-lg m-2">No</button>
      <button id="forgiveYesBtn" class="bg-green-400 text-white px-4 py-2 rounded-lg m-2">Yes</button>
    </div>
    
    <!-- Step 4 -->
    <div id="step4" class="hidden">
      <h1 class="text-2xl font-bold text-green-600 mb-4">YAY!! ðŸŽ‰</h1>
      <p class="text-lg">Thank you for forgiving me ðŸ’–</p>
    </div>
    
  </div>

  <script>
    const noBtn = document.getElementById("noBtn");
    const yesBtn = document.getElementById("yesBtn");
    const forgiveNoBtn = document.getElementById("forgiveNoBtn");
    const forgiveYesBtn = document.getElementById("forgiveYesBtn");

    // Step 1 logic
    noBtn.addEventListener("click", () => {
      alert("You are lying ðŸ˜¤");
      noBtn.disabled = true;
      noBtn.classList.add("opacity-50");
    });

    yesBtn.addEventListener("click", () => {
      document.getElementById("step1").classList.add("hidden");
      document.getElementById("step2").classList.remove("hidden");
    });

    // Step 2 logic (smooth Formspree submit)
    document.getElementById("reasonForm").addEventListener("submit", function(e) {
      e.preventDefault();  // stop reload

      const form = this;
      const data = new FormData(form);

      fetch(form.action, {
        method: 'POST',
        body: data,
        headers: { 'Accept': 'application/json' }
      })
      .then(response => {
        if (response.ok) {
          document.getElementById("step2").classList.add("hidden");
          document.getElementById("step3").classList.remove("hidden");
        } else {
          alert("Oops! Something went wrong.");
        }
      })
      .catch(error => {
        console.error("Form submission error:", error);
        alert("Oops! Something went wrong.");
      });
    });

    // Step 3 logic
    forgiveNoBtn.addEventListener("click", () => {
      alert("Oga, you donâ€™t have a choice ðŸ˜");
      forgiveNoBtn.disabled = true;
      forgiveNoBtn.classList.add("opacity-50");
    });

    forgiveYesBtn.addEventListener("click", () => {
      document.getElementById("step3").classList.add("hidden");
      document.getElementById("step4").classList.remove("hidden");

      // ðŸŽ‰ Continuous Confetti + Hearts for 5 seconds
      let duration = 5 * 1000;
      let end = Date.now() + duration;

      (function frame() {
        confetti({
          particleCount: 5,
          angle: 60,
          spread: 55,
          origin: { x: 0 }
        });
        confetti({
          particleCount: 5,
          angle: 120,
          spread: 55,
          origin: { x: 1 }
        });
        confetti({
          particleCount: 2,
          spread: 70,
          shapes: ['circle'],
          scalar: 2,
          origin: { y: 0.6 },
          colors: ['#ff69b4', '#ff1493', '#ff0000']
        });

        if (Date.now() < end) {
          requestAnimationFrame(frame);
        }
      }());

      // ðŸ’• Falling heart emojis
      let heartInterval = setInterval(() => {
        let heart = document.createElement("div");
        heart.classList.add("heart");
        heart.style.left = Math.random() * 100 + "vw";
        heart.innerHTML = "ðŸ’–";
        document.body.appendChild(heart);

        setTimeout(() => {
          heart.remove();
        }, 5000);
      }, 300);

      setTimeout(() => clearInterval(heartInterval), duration);
    });
  </script>
</body>
</html>
